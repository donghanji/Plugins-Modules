/*
   module.js ,version 1.2.1 ,updated on 2015-01-31
   module for Plugins Modules library.

   https://github.com/donghanji/pm
 */

"use strict";!function(a,b){if(!a.module){var c=a.document,d=a.location.pathname,e={},f=Object.prototype.toString,g={SLASHDIR:/^\//,BASEDIR:/.*(?=\/.*$)/,JSSUFFIX:/\.js(?:\?\w+\=\w+)?$/,PARAMSUFFIX:/\.js\?\w+\=\w+$/,COMMENT:/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,REQUIRE:/(?:^|[^.$])\brequire\s*\(\s*(["'])([^"'\s\)]+)\1\s*\)/g,REQUIRE_FUN:/^function \(\w*\)/,MODULENAME:/\/([\w.]+)?(?:\1)?$/,PLACEHOLDER_DIR:/\{([^\}\{]+)?\}/g},h={ERROR:-1,BEGIN:0,LOADING:1,LOADED:2,END:3},i=1,j={version:"0.0.2",options:{require:!1,nocache:!1,debug:!1,timeout:7e3,mined:"",base:"",dirs:{},alias:{},files:[],coms:{},defaults:{},globals:{}}},k=j.util={},l=j.path={};k.extend=function(){var a,b=arguments[0]||{},c=arguments.length,d=1;for(c===d&&(b=this,--d);c>d;d++)if(a=arguments[d],"object"==typeof a)for(var e in a)b[e]=a[e];return b},k.extend({type:function(a){return null==a?String(a):e[f.call(a)]||"object"},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},isString:function(a){return"string"===k.type(a)},isFunction:function(a){return"function"===k.type(a)},isObject:function(a){return"object"===k.type(a)},isArray:function(a){return"array"===k.type(a)}}),k.now=function(){return(new Date).getTime()},k.uid=function(){return[k.now(),i++,Math.floor(1e6*Math.random())].join("")},k.isEmpty=function(a){return""===a||a===b||null===a?!0:k.isArray(a)?a.length?!1:!0:k.isObject(a)?k.isEmptyObject(a):!1},k.isEmptyObject=function(a){for(var b in a)return!1;return!0},k.each=function(a,c){var d=0,e=a.length,f=e===b||k.isFunction(a);if(f){for(var g in a)if(c.call(a[g],g,a[g])===!1)break}else for(;e>d&&c.call(a[d],d,a[d++])!==!1;);},k.each("Boolean,Number,String,Function,Array,Date,RegExp,Object".split(","),function(a,b){e["[object "+b+"]"]=b.toLowerCase()}),k.keys=Object.keys||function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},k.unique=function(a){var b={};return k.each(a,function(a,c){b[c]=1}),k.keys(b)},k.isInArray=function(a,b){if(!k.isArray(a))return!1;for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1},k.parseDependencies=function(a){a=a.replace(g.COMMENT,"");var b,c=[],d=g.REQUIRE;for(d.lastIndex=0;b=d.exec(a);)b[2]&&c.push(b[2]);return k.unique(c)},k.path2name=function(a){if(k.isArray(a)){var b=[];return k.each(a,function(a,c){c=k.path2name(c),b.push(c)}),b}var c=g.MODULENAME,d=c.exec(a);return d&&d.length>1&&(a=d[1].replace(g.JSSUFFIX,"")),a},l.dirname=function(a){var b=a.match(g.BASEDIR);return(b?b[0]:".")+"/"},l.realpath=function(a){var b=j.options.base;return-1===a.indexOf("//")&&(a=b+a),a};var m={},n=[],o={},p=j.options;p.base=l.dirname(d),j.replace=function(a,b){var c=g.PLACEHOLDER_DIR;return b.replace(c,function(){var b=arguments;if(b.length>=4){var c=b[1],d=a[c]||c||"";return b[3].replace(b[3],d)}return b[3]})},j.dirs=function(a){a=k.isObject(a)?a:{};var b=p.dirs;for(var c in a)a[c]=j.replace(b,a[c]);return a},j.config=function(b){b=k.isObject(b)?b:{},p=k.extend(p,b),p.alias=j.dirs(p.alias);var c=p.mined,d=/^\./;c=c&&!d.test(c)?"."+c:c,p.mined=c,p.require===!0&&(a.require=j.declare,a.define=j.declare,a.define.remove=j.remove),p.debug===!0&&(j.ModulesSet=m,j.ModuleCachesQueue=n,j.StatusCacheQueue=o,a.module=j)},j.alias=function(a){return k.isEmpty(a)?p.alias:(a=k.isObject(a)?a:{},a=j.dirs(a),void(p.alias=k.extend(a,p.alias)))},j.files=function(a){if(k.isEmpty(a))return p.files;if(k.isString(a)&&(a=[].concat(a)),k.isObject(a)){var b=[];k.each(a,function(a){b.push(a)}),j.alias(a),a=b}p.files=k.unique(p.files.concat(a))},j.globals=function(a){return k.isEmpty(a)?p.globals:k.isString(a)?p.globals[a]||"":(a=k.isObject(a)?a:{},void(p.globals=k.extend(a,p.globals)))},j.defaults=function(a,c){if(k.isEmpty(a))return p.defaults;if(k.isObject(a))for(var d in a)j.defaults(d,a[d]);else{if(a=j.aliasId(a),c===b)return p.defaults[a]||{};c=k.isObject(c)?c:{},p.defaults[a]=p.defaults[a]||{},p.defaults[a]=k.extend(c,p.defaults[a])}},j.scripts=function(){return c.getElementsByTagName("script")},j.createScript=function(a,d){d=d===b||d?!0:!1;var e=c.createElement("script");return e.setAttribute("data-requiremodule",a),e.type="text/javascript",e.charset="utf-8",e.async=d,e},j.getScriptData=function(a){var b=a.currentTarget||a.srcElement;return b.detachEvent?(b&&b.detachEvent("onreadystatechange",j.onScriptLoad),b&&b.detachEvent("error",j.onScriptError)):(b&&b.removeEventListener("load",j.onScriptLoad,!1),b&&b.removeEventListener("error",j.onScriptError,!1)),{node:b,id:b&&b.getAttribute("data-requiremodule")}},j.loadJS=function(a){var b=j.isInComs(a);if(a=null!==b?b:a,!(j.getStatus(a)>h.BEGIN)){j.statusSet(a,h.LOADING);var d=c.getElementsByTagName("head")[0],e=j.createScript(a),f=j.aliasId(a,"v"),i=l.realpath(f);i+=p.mined,g.JSSUFFIX.test(i)||(i+=".js"),p.nocache&&!g.PARAMSUFFIX.test(i)&&(i=[i,"?t=",k.now()].join("")),e.src=i,d.appendChild(e),e.attachEvent?(e.attachEvent("onreadystatechange",j.onScriptLoad),e.attachEvent("onerror",j.onScriptError)):(e.addEventListener("load",j.onScriptLoad,!1),e.addEventListener("error",j.onScriptError,!1))}},j.removeJS=function(a){a=j.aliasId(a),k.each(j.scripts(),function(b,c){return c&&c.getAttribute("data-requiremodule")===a?(c.parentNode.removeChild(c),!0):void 0})},j.onScriptLoad=function(a){var b=a.currentTarget||a.srcElement;if("load"===a.type||"readystatechange"===a.type&&("loaded"===b.readyState||"complete"===b.readyState)){var c=j.getScriptData(a),d=c.id;j.statusSet(d,h.LOADED),j.isInFiles(d)&&(j.compile(d),j.complete(d,[],function(){return{}}))}},j.onScriptError=function(a){var b=j.getScriptData(a),c=b.id;j.statusSet(c,h.ERROR),j.compile(c),j.removeJS(c)},j.statusSet=function(a,b){a=j.aliasId(a),o[a]||(o[a]={}),o[a].status=b},j.getStatus=function(a){return a=j.aliasId(a),o[a]&&o[a].status||h.BEGIN},j.load=function(a){k.each(a,function(a,b){j.loadJS(b)})},j.isInAlias=function(a){var b=p.alias;for(var c in b){var d=k.path2name(b[c]);if(c===a||d===a||b[c]===a)return{k:c,v:b[c]}}return null},j.aliasId=function(a,b){b=b||"k";var c=j.isInAlias(a);return a=c&&c[b]||a},j.isInFiles=function(a){var b=p.files,c=0,d=b.length;for(a=j.aliasId(a);d>c;c++)if(b[c]===a)return!0;return!1},j.isInComs=function(a){var b=p.coms,c=j.aliasId(a),d=j.aliasId(a,"v");for(var e in b)if(c===e||k.isInArray(b[e],c)||k.isInArray(b[e],d))return e;return null},j.isInModules=function(a){return a=j.aliasId(a),m[a]},j.noInModulesItems=function(a){var b=[];return k.each(a,function(a,c){j.isInModules(c)||b.push(c)}),b},j.isRequire=function(a){return a?g.REQUIRE_FUN.test(a):!1},j.moduleSet=function(a,b,c){if(a=j.aliasId(a),j.isInModules(a)&&k.isFunction(c)){if(j.isRequire(c.toString()))return c(this.declare);throw'module "'+a+'" already defined!'}k.isFunction(c)&&(m[a]={id:a,dependencies:b,factory:c})},j.compile=function(a){a=j.aliasId(a);var b=j.aliasId(a,"v");k.each(n,function(c,d){function e(){for(var b=0,c=f.length;c>b;b++)if(f[b]===a)return f.splice(b,1),j.compile(a)}if(d){var f=d.links||[];if(k.isInArray(f,a)||k.isInArray(f,b)){if(f.length<=1){var g=d.id||k.uid(),h=d.dependencies||[],i=d.factory||"",l=m[a]||{},o=l.dependencies||[];h=h.concat(o),h=k.unique(h),n.splice(c,1),j.complete(g,h,i)}e()}}})},j.complete=function(a,b,c){j.moduleSet(a,b,c);var d=j.exports(a);return j.compile(a),d},j.build=function(a){var b=a.factory;a.exports={},delete a.factory;var c=b(this.declare,a.exports,a);return k.isEmptyObject(a.exports)&&(a.exports=c||{}),a.exports},j.exports=function(a){if(j.isInModules(a)){a=j.aliasId(a);var b=m[a].factory?j.build(m[a]):m[a].exports;return b}return null},j.declare=function(a,b,c){b=b||[],k.isArray(a)&&(c=b,b=a,a=""),k.isFunction(b)&&(c=b,b=[]),k.isFunction(a)&&(c=a,b=k.parseDependencies(c.toString())||[],a=""),a=a||k.uid();var d=j.noInModulesItems(b);if(d&&d.length){var e={id:a,dependencies:b,factory:c,links:k.path2name(d)};return n.push(e),j.load(b)}return j.complete(a,b,c)},j.remove=function(a){a=j.aliasId(a),a&&(j.removeJS(a),delete o[a],delete m[a])};var q=["config","alias","files","globals","defaults","declare"];a.module=a.module||{},k.each(q,function(b,c){a.module[c]=j[c]})}}(window);